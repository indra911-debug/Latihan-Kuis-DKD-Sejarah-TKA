<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuis Sejarah Indonesia 40 Soal</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for better readability and aesthetics */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .question-container {
            border-left: 4px solid #3b82f6; /* Blue border for emphasis */
            padding-left: 1rem;
        }
        .option-label {
            transition: all 0.2s;
            cursor: pointer;
        }
        .option-label:hover {
            background-color: #eff6ff; /* Light blue on hover */
        }
        input[type="radio"]:checked + .option-label,
        input[type="checkbox"]:checked + .option-label {
            background-color: #dbeafe; /* Lighter blue when checked */
            border-color: #3b82f6;
            font-weight: 600;
        }
        /* Style untuk Message Box */
        #messageBox {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            max-width: 300px;
        }
        .message-item {
            padding: 1rem;
            margin-bottom: 0.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            transition: opacity 0.3s ease-out;
            opacity: 1;
        }
        .message-success { background-color: #d1fae5; color: #065f46; border: 1px solid #10b981; }
        .message-error { background-color: #fee2e2; color: #991b1b; border: 1px solid #ef4444; }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div id="app" class="max-w-4xl mx-auto bg-white p-6 sm:p-10 rounded-xl shadow-2xl">
        <header class="mb-8 text-center border-b pb-4">
            <h1 class="text-3xl font-extrabold text-gray-800">Kuis Sejarah Indonesia</h1>
            <p id="pageTitle" class="text-lg text-blue-600 mt-1"></p>
        </header>

        <!-- Konten Kuis akan dirender di sini -->
        <div id="content">
            <!-- Loading message or intro screen will appear first -->
        </div>

        <!-- Tombol navigasi (dirender oleh JS) -->
        <div id="navigation" class="mt-8 pt-4 border-t flex justify-end">
            <button id="submitButton" onclick="submitQuiz()" class="hidden bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition duration-300">
                Kirim Hasil & Selesai
            </button>
        </div>

        <!-- Modal untuk loading saat kirim data -->
        <div id="loadingModal" class="fixed inset-0 bg-gray-600 bg-opacity-75 hidden items-center justify-center z-50">
            <div class="bg-white p-6 rounded-lg shadow-xl flex flex-col items-center">
                <svg class="animate-spin -ml-1 mr-3 h-8 w-8 text-blue-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                <p class="mt-3 text-gray-700 font-semibold">Mengirim data hasil kuis...</p>
            </div>
        </div>
    </div>
    
    <!-- Message Box untuk menampilkan notifikasi non-blocking -->
    <div id="messageBox"></div>

    <script>
        // =================================================================
        // 1. KONFIGURASI URL & DATA KUIS (JavaScript Klien)
        // =================================================================
        // URL WEB APP APPS SCRIPT ANDA
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbzdd2IGnCPjusGf38hm4pxdhycF6jUEZA4P6TmzUHCqFHXqkO4rXizuqGZPBlkg_aJF/exec'; 
        
        // 2. Question Data: Jawaban Benar dan Penjelasan LENGKAP (40 SOAL)
        const quizQuestions = [
            // --- Q1 & Q2 CONTEXT: Pameran Sunting ---
            {
                qNum: 1,
                type: 'mc',
                topic: 'Teks berikut untuk menjawab soal nomor 1 dan 2. Museum Nasional Indonesia menggelar pameran Sunting: Jejak Perempuan Indonesia Penggerak Perubahan hingga Juli 2025. Pameran ini dibuka bertepatan dengan peringatan hari Kartini. Pameran Sunting terbagi menjadi tiga zona utama, yaitu zona 1 menampilkan 14 tokoh perempuan pemimpin dan pejuang, zona 2 menampilkan 29 tokoh yang berperan dalam dinamika sosial politik Indonesia, serta zona 3 berisi 53 tokoh perempuan yang berjasa dalam bidang pendidikan, seni, kesehatan, diplomasi, dan teknologi. Sebanyak tujuh belas organisasi perempuan juga ditampilkan sebagai bentuk perjuangan kolektif perempuan Indonesia. Selain itu, pameran menyuguhkan artefak lintas budaya dan lintas waktu yang mencakup arsip, karya sastra, karya seni, dan dokumentasi mengenai rekam jejak perjuangan perempuan Indonesia.',
                text: 'Pameran Sunting menampilkan tokoh-tokoh perempuan dari berbagai latar belakang dan peran aktif perempuan dalam sejarah Indonesia. Bagaimana keterkaitan perjuangan perempuan pada masa lalu dengan dinamika sosial budaya perempuan indonesia saat ini?',
                options: [
                    'A. Perjuangan perempuan masa lalu menjadi landasan bagi peran aktif perempuan di berbagai bidang saat ini.',
                    'B. Perempuan masa kini aktif menyuarakan hak-haknya karena peran laki-laki dalam masyarakat mulai melemah.',
                    'C. Semangat perjuangan tokoh perempuan dahulu mendorong berkembangnya tren perempuan mandiri masa kini.',
                    'D. Perjuangan perempuan masa kini lebih modern dan tidak memiliki hubungan dengan sejarah perjuangan perempuan.',
                    'E. Perjuasaan perempuan masa kini lebih fokus pada kegiatan budaya dan kurang berkontribusi terhadap perubahan politik.'
                ],
                answer: 'A', 
                explanation: 'Perjuangan tokoh perempuan di masa lalu meletakkan fondasi kuat bagi perempuan Indonesia untuk berperan aktif di berbagai sektor kehidupan saat ini, menunjukkan adanya kebertanjutan sejarah.' 
            },
            {
                qNum: 2,
                type: 'tf',
                topic: 'Lanjutan konteks soal 1: Museum Nasional Indonesia menggelar pameran Sunting.',
                text: 'Teks di atas mengandung konsep berpikir sejarah. Pilihlah Benar atau Salah pada pernyataan berikut yang menunjukan konsep berfikir sejarah',
                statements: [
                    'Pameran Sunting tidak disusun secara kronologis.',
                    'Pameran Sunting menunjukkan kebertanjutan peran perempuan dalam berbagai bidang',
                    'Peristiwa yang dialami oleh tokoh-tokoh perempuan dalam pameran memiliki pola yang sama.'
                ],
                answers: ['Salah', 'Benar', 'Salah'], 
                explanation: 'Konsep berpikir sejarah mencakup kesinambungan (kebertanjutan) peran perempuan lintas waktu (pernyataan 2). Pernyataan 1 tidak dapat dipastikan hanya dari teks. Pernyataan 3 tidak tepat karena tokoh berbeda memiliki pola yang beragam.'
            },
            
            // --- Q3 CONTEXT: Tanam Paksa vs Swasembada ---
            {
                qNum: 3,
                type: 'ms',
                topic: 'Pada masa kolonial Belanda, rakyat diwajibkan menanam tanaman ekspor, seperti kopi, tebu, dan nila melalui sistem tanam paksa. Setelah Indonesia merdeka, kebijakan pertanian mengalami perubahan besar. Pemerintah mulai menerapkan kebijakan yang lebih berorientasi pada kesejahteraan petani melalui program swasembada pangan dan koperasi pertanian.',
                text: 'Manakah pernyataan yang menunjukkan perubahan kebijakan pertanian dari masa kolonial ke masa kemerdekaan? Jawaban benar lebih dari satu.',
                options: [
                    'Penerapan koperasi pertanian untuk menggantikan sistem tanam paksa.',
                    'Perubahan kebijakan pertanian dari tanam paksa ke swasembada pangan.',
                    'Pergeseran fokus kebijakan dari kepentingan kolonial ke kepentingan nasional.',
                    'Penggunaan teknologi modern dalam pertanian sejak masa penjajahan Belanda.',
                    'Penggunaan lahan pertanian rakyat dari masa kolonial hingga masa kemerdekaan.'
                ],
                answers: [true, true, true, false, false], 
                explanation: 'Perubahan utama adalah dari eksploitasi (Tanam Paksa) ke kesejahteraan rakyat (Koperasi, Swasembada) dan pergeseran fokus dari kolonial ke nasional.'
            },

            // --- Q4 & Q5 CONTEXT: UU Agraria 1870 & Kopi Pasuruan ---
            {
                qNum: 4,
                type: 'mc',
                topic: 'Teks berikut untuk menjawab soal nomor 4 dan 5. Pada masa pemerintahan kolonial Belanda, Keresidenan Pasuruan menjadi salah satu wilayah budi daya tanaman kopi yang berkembang pesat. Berdasarkan data dalam buku Village Java Under the Cultivation System yang diambil dari Kultuur Verslag 1834, terdapat sekitar 17.775 petani kopi di wilayah Keresidenan Pasuruan dengan jumlah pohon kopi mencapai 10.124.145. Jumlah tersebut terus meningkat dari tahun ke tahun sejak 1836 hingga 1844. Memasuki 1870-an terbit Undang-Undang Agraria 1870 yang mengatur pemberian hak sewa atas tanah yang belum digarap kepada pengusaha swasta. Dengan terbitnya peraturan ini banyak pengusaha asing yang mendirikan perkebunan dan ikut meramaikan pasar ekonomi. Selain itu, Undang-Undang Agraria mendorong pembukaan lahan perkebunan di daerah pergunungan.',
                text: 'Kamu ingin meneliti lebih dalam tentang dampak diterbitkannya Undang-Undang Agraria 1870 terhadap perkebunan kopi di Keresidenan Pasuruan. Manakah langkah paling tepat untuk mendukung penelitianmu?',
                options: [
                    'A. Menguji sampel tanah dari lahan bekas perkebunan kopi di Pasuruan.',
                    'B. Menggunakan peta kontemporer untuk menunjukkan lokasi perdagangan kopi.',
                    'C. Menyebarkan survei daring kepada masyarakat Pasuruan mengenai sejarah kopi.',
                    'D. Melakukan observasi langsung ke kebun kopi saat ini dan mewawancarai petani lokal.',
                    'E. Membandingkan laporan kolonial dan arsip kepemilikan tanah sebelum dan sesudah 1870.'
                ],
                answer: 'E', 
                explanation: 'Untuk meneliti dampak UU tahun 1870, sumber paling tepat adalah arsip dan laporan dari masa sebelum dan sesudah 1870 untuk perbandingan (metode historis).'
            },
            {
                qNum: 5,
                type: 'ms',
                topic: 'Lanjutan konteks soal 4: UU Agraria 1870 dan Keresidenan Pasuruan.',
                text: 'Berdasarkan teks, manakah pernyataan yang menunjukkan contoh sumber primer dalam penulisan sejarah? Pilihlah jawaban yang benar! Jawaban benar lebih dari satu.',
                options: [
                    'Data peningkatan jumlah pohon kopi antara 1836-1844.',
                    'Hasil wawancara tahun 2020 dengan keturunan petani kopi di Pasuruan.',
                    'Buku sejarah modern yang mengulas sistem tanam paksa di Jawa Timur.',
                    'Laporan Kultuur Verslag 1834 tentang jumlah petani dan pohon kopi di Pasuruan.',
                    'Naskah Undang-Undang Agraria 1870 yang diterbitkan oleh pemerintah kolonial Belanda.'
                ],
                answers: [true, false, false, true, true], 
                explanation: 'Sumber primer adalah dokumen asli atau kesaksian langsung dari masa peristiwa, yaitu data periode 1836-1844, Kultuur Verslag 1834, dan naskah UU Agraria 1870.'
            },

            // --- Q6 CONTEXT: Fungsi Sumber Sejarah ---
            {
                qNum: 6,
                type: 'tf',
                topic: 'Alya sedang menulis karya tulis sejarah tentang perjuangan rakyat dalam peristiwa Bandung Lautan Api. la mengumpulkan informasi dari berbagai sumber, seperti arsip surat perintah militer, foto dokumentasi peristiwa, serta catatan kesaksian warga yang masih hidup.',
                text: 'Pilihlah Tepat atau Tidak Tepat untuk setiap pernyataan yang menunjukkan fungsi sumber-sumber tersebut!',
                statements: [
                    'Memperkuat opini pribadi penulis sejarah.',
                    'Mengurangi keragaman perspektif terhadap peristiwa sejarah.',
                    'Memberikan bukti dan data yang objektif terhadap peristiwa sejarah.'
                ],
                answers: ['Tidak Tepat', 'Tidak Tepat', 'Tepat'], 
                explanation: 'Fungsi sumber sejarah adalah untuk memberikan bukti objektif (tepat). Sumber tidak boleh digunakan untuk memperkuat opini pribadi atau mengurangi keragaman perspektif (tidak tepat).'
            },

            // --- Q7 & Q8 CONTEXT: Penyebaran Hindu-Buddha & Perdagangan ---
            {
                qNum: 7,
                type: 'ms',
                topic: 'Teks berikut untuk menjawab soal nomor 7 dan 8. Kedatangan agama Hindu dan Buddha merupakan salah satu babak penting dalam sejarah awal Nusantara. Perdagangan maritim dan perkembangan kerajaan Hindu-Buddha sangat berhubungan erat. Kerajaan seperti Kutai, Tarumanegara, dan Sriwijaya berkembang di lokasi-lokasi strategis, menguasai pelabuhan, memungut pajak, dan menggunakan kekayaan untuk membangun tempat peribadatan, membiayai biksu/brahmana, serta mendukung pengembangan seni dan sastra keagamaan. Perdagangan maritim menjadi fondasi bagi pusat-pusat kebudayaan Hindu-Buddha di Asia Tenggara.',
                text: 'Apa peran jalur perdagangan bagi penyebaran agama Hindu-Buddha di Nusantara? Pilihlah jawaban yang benar! Jawaban benar lebih dari satu.',
                options: [
                    'Jalur perdagangan maritim menjadi media bagi perpindahan individu, seperti pedagang, biksu, dan cendekiawan.',
                    'Komoditas dagang seperti rempah-rempah secara langsung digunakan sebagai alat tukar untuk mengajarkan ajaran agama.',
                    'Interaksi di pelabuhan pelabuhan memfasilitasi pertukaran budaya dan ideologi di antara berbagai bangsa.',
                    'Para pedagang mendirikan candi dan wihara di setiap pelabuhan sebagai pusat penyebaran agama secara massal.',
                    'Jalur perdagangan mempermudah akses bagi masyarakat Nusantara untuk belajar langsung ke India dan kembali menyebarkannya.'
                ],
                answers: [true, false, true, false, false], 
                explanation: 'Jalur perdagangan memfasilitasi pertukaran individu (pedagang, biksu) dan pertukaran budaya/ideologi di pelabuhan (sesuai teks).'
            },
            {
                qNum: 8,
                type: 'tf',
                topic: 'Lanjutan konteks soal 7: Penyebaran Hindu-Buddha dan Perdagangan Maritim.',
                text: 'Pilihlah Benar atau Salah untuk setiap pernyataan berikut sesuai dengan informasi pada teks!',
                statements: [
                    'Perdagangan hanya membawa keuntungan ekonomi tanpa memperkaya khazanah budaya masyarakat Nusantara.',
                    'Jalur rempah memainkan peran penting dalam menarik para pelaut dan pedagang dari India sehingga memfasilitasi masuknya pengaruh Hindu-Buddha.',
                    'Teori Brahmana dan Waisya merupakan dua dari beberapa teori yang menjelaskan bahwa agama Hindu-Buddha masuk ke Nusantara melalui jalur militer.'
                ],
                answers: ['Salah', 'Benar', 'Salah'], 
                explanation: 'Perdagangan juga memperkaya budaya (salah). Jalur rempah/maritim penting (benar). Teori Brahmana dan Waisya tidak menjelaskan masuknya agama melalui jalur militer (salah).'
            },

            // --- Q9 CONTEXT: Peran Raja Majapahit ---
            {
                qNum: 9,
                type: 'mc',
                topic: 'Soal ini merujuk pada kepercayaan konsep Dewa-Raja dalam kebudayaan Hindu-Buddha di Nusantara.',
                text: 'Manakah peran raja dalam pemerintahan Majapahit berdasarkan konsep Dewa-Raja?',
                options: [
                    'A. Pemimpin agama', 'B. Panglima perang', 'C. Perwujudan dewa', 'D. Penjaga alam semesta', 'E. Pemimpin seluruh rakyat'
                ],
                answer: 'C', 
                explanation: 'Konsep Dewa-Raja menganggap raja sebagai perwujudan dewa (misalnya Wisnu atau Syiwa) yang memerintah di dunia.'
            },

            // --- Q10 CONTEXT: Penyebaran Islam Melalui Perkawinan ---
            {
                qNum: 10,
                type: 'mc',
                topic: 'Soal ini merujuk pada salah satu saluran penyebaran Islam, yaitu perkawinan, yang sering terjadi antara pedagang Muslim dan bangsawan lokal.',
                text: 'Pada awal perkembangan islam di Nusantara, para pedagang muslim Timur Tengah melakukan perkawinan dengan bangsawan lokal. Manakah pernyataan yang menunjukkan dampak perkawinan tersebut?',
                options: [
                    'A. Para penguasa lokal mendapatkan keuntungan ekonomis', 
                    'B. Pedagang muslim berpotensi menjadi pejabat tinggi kerajaan.', 
                    'C. Terjadinya konsesi dagang yang merugikan para penguasa lokal.', 
                    'D. Banyak bangsawan lokal melakukan migrasi ke negara-negara Timur Tengah,', 
                    'E. Banyak keluarga kerajaan yang masuk islam dan melahirkan generasi muslim baru.'
                ],
                answer: 'E', 
                explanation: 'Saluran perkawinan bertujuan memperluas pengaruh Islam secara damai dan politis, sehingga berdampak pada lahirnya generasi muslim baru dari kalangan bangsawan.'
            },

            // --- Q11 & Q12 CONTEXT: Kerajaan Samudera Pasai ---
            {
                qNum: 11,
                type: 'tf',
                topic: 'Teks berikut untuk menjawab soal nomor 11 dan 12. Kerajaan Samudera Pasai yang terletak di pesisir utara Pulau Sumatra mengukir kejayaan Islam pada abad XIII-XV Masehi. Kejayaan ini didukung tiga pilar: jaringan maritim, sistem pemerintahan terstruktur, dan penyebaran Islam. Sultan Malik as-Saleh sebagai pendiri berperan penting mengorganisasi pemerintahan dan memperkenalkan Islam. Samudera Pasai memiliki birokrasi efektif untuk mengatur perdagangan, perpajakan, dan urusan pemerintahan. Sistem hukum Islam (syariat) diterapkan dalam kehidupan sehari-hari, termasuk transaksi perdagangan dan penyelesaian sengketa.',
                text: 'Pilihlah Benar atau Salah pada pernyataan berikut berdasar informasi pada teks!',
                statements: [
                    'Letak geografis yang strategis di jalur perdagangan antara Timur dan Barat menjadi salah satu faktor kunci kejayaan maritim Kerajaan Samudera Pasai.',
                    'Peran Sultan Malik as-Saleh merupakan satu-satunya faktor di balik seluruh kejayaan Samudera Pasai dari ekonomi hingga penyebaran agama.',
                    'Hukum syariat yang diterapkan di Samudera Pasai tidak hanya terbatas pada urusan agama, tetapi juga mengatur aspek-aspek kehidupan lain seperti perdagangan dan penyelesaian sengketa.'
                ],
                answers: ['Benar', 'Salah', 'Benar'], 
                explanation: 'Teks menyebut tiga pilar, sehingga Sultan bukan satu-satunya faktor (salah). Teks secara eksplisit menyebut syariat mengatur perdagangan dan sengketa (benar).'
            },
            {
                qNum: 12,
                type: 'ms',
                topic: 'Lanjutan konteks soal 11: Tiga Pilar Kejayaan Samudera Pasai.',
                text: 'Keterkaitan antara tiga pilar kejayaan Kerajaan Samudera Pasai begitu kuat sehingga satu pilar akan memengaruhi pilar lainnya. Manakah pernyataan yang menunjukkan hubungan timbal balik antara aspek jaringan maritim yang luas dan aktivitas penyebaran agama Islam? Jawaban benar lebih dari satu.',
                options: [
                    'Jaringan maritim yang luas menyediakan jalur bagi para ulama dan pedagang muslim untuk menyebarkan ajaran Islam.',
                    'Kejayaan maritim mendorong Samudera Pasai untuk mengirim ekspedisi militer guna menyebarkan Islam ke wilayah lain.',
                    'Ajaran Islam yang diterapkan di Samudera Pasai memberikan kode etik dan kepercayaan yang menarik lebih banyak pedagang asing.',
                    'Penyebaran Islam menghasilkan banyak tenaga kerja ahli di bidang maritim sehingga memperkuat jaringan perdagangan.',
                    'Sultan memanfaatkan pajak dari perdagangan maritim untuk membiayai pembangunan masjid di seluruh Sumatra.'
                ],
                answers: [true, false, true, false, true], 
                explanation: 'Jalur maritim memfasilitasi ulama (benar). Etika Islam menarik pedagang (benar). Pajak dari maritim membiayai kegiatan keagamaan (benar, meski teks menyebut pembangunan tempat peribadatan secara umum).'
            },
            
            // --- Q13 CONTEXT: Dampak Kolonialisme (General) ---
            {
                qNum: 13,
                type: 'tf',
                topic: 'Kedatangan bangsa Erupa ke Nusantara berdampak pada politik, sosial, dan budaya. Monopoli perdagangan, tanam paksa mengubah struktur agraria. Dalam bidang sosial, kasta dipertahankan, pendidikan dibatasi. Namun, sistem birokrasi, infrastruktur, dan pengenalan teknologi modern menjadi warisan kolonial yang berdampak jangka panjang.',
                text: 'Pilihlah Benar atau Salah pada pernyataan terkait dampak kolonialisme bangsa Eropa terhadap Nusantara!',
                statements: [
                    'Kebijakan politik etis sepenuhnya berhasil meningkatkan kesejahteraan bumiputra.',
                    'Pendidikan masa kolonial dirancang untuk mendukung munculnya kesadaran nasional rakyat.',
                    'Struktur birokrasi modern yang diperkenalkan Belanda berdampak pada sistem administrasi masa kini.'
                ],
                answers: ['Salah', 'Salah', 'Benar'], 
                explanation: 'Politik Etis tidak sepenuhnya berhasil (salah). Pendidikan kolonial dirancang untuk kepentingan kolonial (salah). Struktur birokrasi modern adalah warisan kolonial yang berdampak hingga kini (benar).'
            },

            // --- Q14 & Q15 CONTEXT: Motivasi 3G ---
            {
                qNum: 14,
                type: 'ms',
                topic: 'Teks berikut untuk menjawab soal nomor 14 dan 15. Pada abad ke XV dan XVI bangsa Eropa mulai menjelajah dunia ke Nusantara. Kedatangan mereka dilatarbelakangi oleh semangat 3G (Gold, Glory, dan Gospel). Motivasi ini mendorong perubahan besar dalam struktur sosial, sistem ekonomi kolonial, intervensi politik lokal, dan perubahan budaya di Nusantara.',
                text: 'Berdasarkan motivasi 3G bangsa Eropa, manakah bentuk keterkaitan antara motivasi dengan tindakan bangsa Eropa di Nusantara? Jawaban benar lebih dari satu.',
                options: [
                    'Mendirikan sekolah Eropa untuk menyebarkan nilai-nilai Barat secara massal.',
                    'Memaksa penduduk lokal untuk menganut agama Katolik melalui misi zending.',
                    'Menerapkan sistem pajak progresif oleh VOC untuk mendorong kesejahteraan ekonomi rakyat.',
                    'Mengangkat raja boneka dan pengaruh terhadap suksesi kerajaan lokal untuk memperluas dominasi.',
                    'Mendirikan benteng dagang dan markas militer di wilayah strategis untuk melindungi jalur perdagangan.'
                ],
                answers: [false, true, false, true, true], 
                explanation: 'Memaksa agama Katolik adalah Gospel (benar). Mengangkat raja boneka adalah Glory (benar). Mendirikan benteng dagang adalah Gold/Glory (benar).'
            },
            {
                qNum: 15,
                type: 'tf',
                topic: 'Lanjutan konteks soal 14: Motivasi 3G dan Dampak Kolonialisme.',
                text: 'Pilihlah Benar atau Salah pada pernyataan berikut terkait dampak kedatangan bangsa Eropa terhadap dinamika sosial, politik, ekonomi, dan budaya di Nusantara!',
                statements: [
                    'Penyebaran agama oleh bangsa Eropa mendorong terjadinya konflik budaya dengan masyarakat lokal.',
                    'Dominasi politik bangsa Eropa menyebabkan lahirnya pemerintahan raja boneka di beberapa kerajaan.',
                    'Campur tangan kolonial di bidang budaya memperkuat identitas budaya lokal secara menyeluruh.'
                ],
                answers: ['Benar', 'Benar', 'Salah'], 
                explanation: 'Intervensi budaya sering memicu konflik (benar). Intervensi politik melahirkan raja boneka (benar). Budaya lokal terpinggirkan, tidak diperkuat (salah).'
            },

            // --- Q16 CONTEXT: Sistem Tanam Paksa ---
            {
                qNum: 16,
                type: 'mc',
                topic: 'Sistem tanam paksa (cultuurstelsel) diberlakukan Belanda pada 1830 untuk mengisi kas negara. Rakyat diwajibkan menanam komoditas ekspor. Dalam praktiknya terjadi penyimpangan, menyebabkan kelaparan dan penderitaan luas, meskipun berhasil bagi keuangan Belanda.',
                text: 'Kebijakan alternatif apa yang tepat untuk menggantikan tanam paksa agar tujuan keuangan pemerintah tetap tercapai tanpa menimbulkan penderitaan rakyat?',
                options: [
                    'A. Mengatur kuota hasil bumi dari rakyat, tetapi memberi kebebasan jenis tanaman yang ditanam.',
                    'B. Mewajibkan petani menanam komoditas ekspor di tanah kosong yang belum dikelola secara intensif.',
                    'C. Memusatkan tanam paksa di wilayah subur dan menghindari penerapannya di daerah rawan bencana.',
                    'D. Mengganti kewajiban menanam komoditas dengan kerja wajib secara bergilir di pabrik milik pemerintah.',
                    'E. Memberlakukan sistem kontrak sukarela dengan insentif harga tetap bagi petani yang menanam tanaman ekspor.'
                ],
                answer: 'E', 
                explanation: 'Sistem kontrak sukarela dengan insentif (bukan paksaan) adalah pendekatan liberal yang lebih adil dan menggantikan sistem eksploitasi.'
            },

            // --- Q17 CONTEXT: Dampak Politik Etis ---
            {
                qNum: 17,
                type: 'mc',
                topic: 'Pada awal abad XX Belanda menerapkan politik etis (irigasi, edukasi, transmigrasi). Tujuan awalnya meningkatkan kesejahteraan demi kepentingan kolonial. Namun, program edukasi melahirkan golongan intelektual bumiputra yang mendirikan organisasi modern (Budi Utomo, Sarekat Islam, Indische Partij) yang menjadi tonggak awal pergerakan nasional.',
                text: 'Manakah simpulan yang tepat berdasarkan teks?',
                options: [
                    'A. Politik etis gagal meningkatkan kesejahteraan rakyat.',
                    'B. Politik etis menurunkan kesadaran politik bangsa Indonesia.',
                    'C. Politik etis menghapus seluruh kebijakan diskriminatif kolonial.',
                    'D. Politik etis melahirkan kaum terpelajar yang menjadi pelopor pergerakan nasional.',
                    'E. Politik etis berhasil mempercepat kemerdekaan Indonesia melalui program pendidikan.'
                ],
                answer: 'D', 
                explanation: 'Teks secara eksplisit menyatakan program edukasi melahirkan golongan intelektual yang menjadi tonggak pergerakan nasional.'
            },

            // --- Q18 & Q19 CONTEXT: Perlawanan Intelektual (Medan Prijaji) ---
            {
                qNum: 18,
                type: 'mc',
                topic: 'Teks berikut untuk menjawab soal nomor 18 dan 19. Pada awal abad XX, perlawanan bergeser dari fisik ke intelektual. Tirto Adhi Soerjo melalui surat kabar Medan Prijaji (terbit 1907) menjadi media perjuangan politik dan sosial untuk menyuarakan kritik terhadap ketidakadilan kolonial. Tirto mendirikan perusahaan pers independen yang dikelola tanpa campur tangan pemerintah. Perlawanan melalui tulisan membuktikan bahwa media massa mampu membangkitkan kesadaran rakyat terhadap kolonialisme.',
                text: 'Apa bentuk perlawanan bangsa Indonesia terhadap kolonialisme Eropa yang tecermin dari aktivitas Tirto Adhi Soerjo melalui surat kabar Medan Prijaji?',
                options: [
                    'A. Pemberontakan bersenjata melawan tentara kolonial.',
                    'B. Gerakan sabotase ekonomi kolonial di kota-kota besar.',
                    'C. Perlawanan diplomatik melalui perwakilan di parlemen Belanda.',
                    'D. Perlawanan melalui media massa untuk membangun kesadaran nasional.',
                    'E. Kerja sama dengan pengusaha bumiputra untuk melemahkan dominasi Belanda.'
                ],
                answer: 'D', 
                explanation: 'Medan Prijaji adalah surat kabar, media perjuangan utama Tirto adalah pers/tulisan untuk membangkitkan kesadaran rakyat.'
            },
            {
                qNum: 19,
                type: 'ms',
                topic: 'Lanjutan konteks soal 18: Perlawanan Intelektual melalui Medan Prijaji.',
                text: 'Manakah dari pernyataan berikut yang mencerminkan nilai-nilai perjuangan rakyat Indonesia pada masa colonial, sebagaimana cermin dalam kiprah Medan Prijaji? Jawaban lebih dari satu',
                options: [
                    'Pers menjadi atat penting dalam menyuarakan keadilan sosial dan kemerdekaan.',
                    'kepatuhan terhadap penguasa kolonial merupakan bentuk perjuangan yang bijaksana.',
                    'Kritik terhadan ketidakadilan sosial dihindari untuk menjaga stabilitas pemerintahan kolonial',
                    'Perlawanan dapat dilakukan melalui pendidikan dan tulisan untuk menggugah kesadaran rakyat',
                    'Rasa nasionalisme dapat tumbuh melalui penyampaian ide-ide kemerdekaan dalam media cetak'
                ],
                answers: [true, false, false, true, true], 
                explanation: 'Medan Prijaji menyuarakan kritik (benar), melawan ketidakadilan (salah jika dihindari), dan membangkitkan kesadaran melalui tulisan (benar).'
            },

            // --- Q20 & Q21 CONTEXT: Indische Partij ---
            {
                qNum: 20,
                type: 'ms',
                topic: 'Teks berikut untuk menjawab soal nomor 20 dan 21. Indische Partij (didirikan oleh Douwes Dekker, Cipto Mangunkusumo, dan Ki Hajar Dewantara) merupakan organisasi politik yang berperan besar dalam perjuangan kemerdekaan. IP menolak kerja sama dengan Belanda (nonkooperatif) dan mendorong rakyat Indonesia untuk berjuang secara mandiri. Tujuannya adalah membangun kesetaraan antara berbagai kelompok masyarakat, terutama menghadapi diskriminasi antara keturunan Belanda dan kaum bumiputra. IP mendapat dukungan dari organisasi lain, seperti Insulinde, Sarekat Islam, dan Budi Utomo. IP juga menyuarakan penolakan terhadap ketidakadilan kolonial melalui poster untuk menyadarkan buruh.',
                text: 'Berdasarkan teks, manakah pernyataan yang menunjukkan strategi perjuangan Indische Partij dalam melawan kolonialisme? Pilihlah jawaban yang benar! Jawaban benar lebih dari satu.',
                options: [
                    'Menjadikan pendidikan Barat sebagai prioritas perjuangan dengan mengesampingkan isu politik,',
                    'Menolak ketergantungan pada kekuatan asing dan mendorong perjuangan secara mandiri,',
                    'Mengedepankan kerja sama dengan pemerintah Belanda agar mendapat pengakuan politik.',
                    'Membangun kesadaran rakyat melalui tulisan, pidato, dan media visual seperti poster.',
                    'Menggalang dukungan dari organisasi lain untuk memperluas basis perjuangan.'
                ],
                answers: [false, true, false, true, true], 
                explanation: 'IP bersifat nonkooperatif (menolak kerja sama), mendorong perjuangan mandiri (benar), dan menggunakan tulisan/poster (benar), serta menggalang dukungan organisasi lain (benar).'
            },
            {
                qNum: 21,
                type: 'tf',
                topic: 'Lanjutan konteks soal 20: Tujuan dan Strategi Indische Partij.',
                text: 'Pilihlah Benar atau Salah pada pernyataan berikut terkait tujuan berdirinya Indische Partij!',
                statements: [
                    'Mempersiapkan pemerintahan kolonial agar lebih demokratis',
                    'Memperkuat hubungan diplomatik dengan pemerintah Belanda.',
                    'Membangun kesetaraan antara keturunan Belanda dan kaum bumiputra.'
                ],
                answers: ['Salah', 'Salah', 'Benar'], 
                explanation: 'Tujuan utama IP adalah kesetaraan (benar), bukan memperkuat Belanda atau demokratisasi pemerintahan kolonial.'
            },

            // --- Q22 CONTEXT: Berakhirnya Kekuasaan Belanda & Jepang ---
            {
                qNum: 22,
                type: 'tf',
                topic: 'Masuknya Jepang ke Indonesia menandai berakhirnya era kolonialisme Belanda. Diawali Serangan Jepang ke Pearl Harbor (7 Des 1941) dan pendaratan di Indonesia awal 1942. Titik balik kekalahan Belanda adalah direbutnya Pangkalan Udara Kalijati, Subang. Belanda akhirnya menyerah tanpa syarat melalui penandatanganan Kapitulasi Kalijati pada 8 Maret 1942.',
                text: 'Pilihlah Benar atau Salah pada pernyataan berikut berkaitan dengan berakhirnya kekuasaan Belanda dan masuknya Jepang di indonesia.',
                statements: [
                    'Letnan Jenderal Hitashi Imamura menjadi tokoh penting dalam proses penyerahan kekuasaan.',
                    'Masuknya Jepang di Indonesia diawali dengan serangan ke Pearl Harbor, Hawail',
                    'Belanda menyerah kepada Jepang melalui perjanjian Renville'
                ],
                answers: ['Benar', 'Benar', 'Salah'], 
                explanation: 'Hitashi Imamura menandatangani Kapitulasi Kalijati (benar). Pearl Harbor adalah titik awal keterlibatan Jepang (benar). Penyerahan Belanda terjadi di Kalijati, bukan Renville (salah).'
            },

            // --- Q23 & Q24 CONTEXT: Pendudukan Jepang ---
            {
                qNum: 23,
                type: 'mc',
                topic: 'Teks berikut untuk menjawab soal nomor 23 dan 24. Masa pendudukan Jepang (1942-1945) membawa perubahan besar. Jepang yang datang dengan slogan "Asia untuk Asia" menerapkan kebijakan yang menguntungkan militer Jepang. Dalam bidang ekonomi, Jepang mengeksploitasi sumber daya alam untuk mendukung perang dan menerapkan kerja paksa (romusa). Di bidang sosial politik, Jepang membentuk organisasi seperti Peta dan Seinendan. Pendidikan diubah untuk mendukung ideologi militer Jepang. Kebijakan ini secara tidak langsung menumbuhkan kesadaran nasional.',
                text: 'Manakah pernyataan berikut yang mencerminkan tujuan utama Jepang dalam penerapan kebijakan ekonomi selama pendudukannya di Indonesia?',
                options: [
                    'A. Mendorong pembangunan industri ringan lokal.', 
                    'B. Meningkatkan ekonomi lokal tanpa kampanye militer.', 
                    'C. Mendukung swasembada pangan bagi rakyat Indonesia.',
                    'D. Menyediakan kompensasi penuh kepada petani romusa.', 
                    'E. Mengeksploitasi sumber daya alam untuk kebutuhan perang Jepang.'
                ], 
                answer: 'E', 
                explanation: 'Teks menyebut Jepang mengeksploitasi sumber daya alam untuk mendukung perang (E).'
            },
            {
                qNum: 24,
                type: 'ms',
                topic: 'Lanjutan konteks soal 23: Masa Pendudukan Jepang di Indonesia.',
                text: 'Meskipun bertujuan untuk kepentingan militer Jepang, kebijakan yang diterapkan secara tidak langsung memberikan dampak positif bagi persiapan kemerdekaan Indonesia. Manakah yang termasuk dampak positif tidak langsung tersebut? Jawaban benar lebih dari satu.',
                options: [
                    'Rakyat Indonesia menerima pelatihan militer dasar melalui PETA dan Seinendan.', 
                    'Jepang memberikan kebebasan penuh pada media massa untuk menyuarakan nasionalisme.', 
                    'Pembentukan organisasi semi-militer melahirkan pemimpin-pemimpin yang berpengalaman.', 
                    'Seluruh pemuda bumiputra mendapat kesempatan pendidikan tinggi secara gratis.', 
                    'Ditinggalkannya sistem birokrasi kolonial Belanda secara menyeluruh.'
                ],
                answers: [true, false, true, false, false], 
                explanation: 'Organisasi semi-militer (PETA, Seinendan) memberikan pelatihan dan pengalaman organisasi yang berguna bagi perjuangan pasca-kemerdekaan.'
            },

            // --- Q25: Peranan VOC ---
            {
                qNum: 25,
                type: 'mc',
                topic: 'Vereenigde Oostindische Compagnie (VOC) adalah kongsi dagang Belanda yang diberi hak istimewa (hak oktroi) oleh pemerintah Belanda.',
                text: 'Hak oktroi yang paling signifikan dampaknya terhadap kedaulatan kerajaan lokal di Nusantara adalah hak untuk...',
                options: [
                    'A. Mencetak mata uang sendiri.',
                    'B. Membangun benteng dan memiliki angkatan perang.',
                    'C. Melakukan monopoli perdagangan rempah-rempah.',
                    'D. Mengangkat dan memberhentikan penguasa lokal.',
                    'E. Menyatakan perang dan mengadakan perjanjian.'
                ],
                answer: 'E', 
                explanation: 'Hak untuk menyatakan perang dan mengadakan perjanjian dengan raja-raja lokal menunjukkan VOC bertindak layaknya sebuah negara, merampas kedaulatan politik kerajaan lokal.'
            },

            // --- Q26: Kebijakan Deandels ---
            {
                qNum: 26,
                type: 'tf',
                topic: 'Gubernur Jenderal Herman Willem Daendels (1808-1811) menerapkan kebijakan kerja paksa, pembangunan Jalan Raya Pos, dan penjualan tanah kepada pihak swasta.',
                text: 'Pilihlah Benar atau Salah: Salah satu tujuan utama Daendels membangun Jalan Raya Pos (Anyer-Panarukan) adalah untuk mempercepat transportasi hasil bumi dan mempermudah pergerakan militer pertahanan dari serangan Inggris.',
                statements: [
                    'Jalan Raya Pos dibangun sepenuhnya menggunakan sistem kerja upah yang adil.',
                    'Tujuan utama pembangunan Jalan Raya Pos adalah pertahanan militer dan ekonomi.',
                    'Kebijakan Daendels membawa dampak positif berupa modernisasi birokrasi lokal.'
                ],
                answers: ['Salah', 'Benar', 'Benar'],
                explanation: 'Jalan Raya Pos dibangun dengan kerja paksa (rodi) (salah). Tujuannya militer dan ekonomi (benar). Daendels memodernisasi birokrasi (benar).'
            },

            // --- Q27: Pembubaran VOC ---
            {
                qNum: 27,
                type: 'ms',
                topic: 'VOC dibubarkan pada 31 Desember 1799. Pembubaran ini disebabkan oleh berbagai faktor internal dan eksternal.',
                text: 'Manakah faktor-faktor yang menjadi penyebab runtuhnya Vereenigde Oostindische Compagnie (VOC)? Jawaban benar lebih dari satu.',
                options: [
                    'Maraknya korupsi di kalangan pegawai VOC.',
                    'Adanya persaingan dagang yang kuat dari kongsi dagang Inggris (EIC).',
                    'Kekalahan Belanda dalam perang melawan Perancis di Eropa.',
                    'Banyaknya biaya perang untuk memadamkan perlawanan rakyat di Nusantara.',
                    'Kebijakan Tanam Paksa yang gagal meningkatkan keuntungan VOC.'
                ],
                answers: [true, true, false, true, false],
                explanation: 'Korupsi, persaingan dagang, dan biaya perang yang tinggi menjadi penyebab utama kebangkrutan VOC.'
            },

            // --- Q28: Organisasi Pergerakan Awal ---
            {
                qNum: 28,
                type: 'mc',
                topic: 'Pergerakan Nasional Indonesia ditandai dengan berdirinya berbagai organisasi modern yang berbeda-beda corak perjuangannya.',
                text: 'Organisasi pertama yang didirikan oleh bangsa Indonesia yang bersifat modern dan bergerak di bidang sosial-budaya pada tahun 1908 adalah...',
                options: [
                    'A. Sarekat Islam', 'B. Indische Partij', 'C. Budi Utomo', 'D. Muhammadiyah', 'E. Perhimpunan Indonesia'
                ],
                answer: 'C',
                explanation: 'Budi Utomo didirikan pada tahun 1908 dan dianggap sebagai pelopor pergerakan nasional modern, fokus awalnya pada pendidikan dan kebudayaan.'
            },

            // --- Q29: Sarekat Islam (SI) ---
            {
                qNum: 29,
                type: 'ms',
                topic: 'Sarekat Islam (SI) awalnya bernama Sarekat Dagang Islam (SDI) dan merupakan organisasi massa yang berkembang sangat pesat.',
                text: 'Manakah yang merupakan tujuan utama dari Sarekat Islam (SI) pada masa awal perkembangannya? Jawaban benar lebih dari satu.',
                options: [
                    'Memperkuat persatuan pedagang Muslim pribumi untuk bersaing dengan pedagang asing.',
                    'Mencapai kemerdekaan Indonesia melalui jalur militer dan revolusi bersenjata.',
                    'Mengembangkan kehidupan keagamaan Islam.',
                    'Memberikan bantuan kepada anggota yang mengalami kesulitan ekonomi.',
                    'Mendirikan negara Islam di Indonesia.'
                ],
                answers: [true, false, true, true, false],
                explanation: 'SI fokus pada persatuan pedagang, keagamaan, dan kesejahteraan anggota.'
            },

            // --- Q30: Sumpah Pemuda ---
            {
                qNum: 30,
                type: 'tf',
                topic: 'Kongres Pemuda II pada 28 Oktober 1928 menghasilkan ikrar yang dikenal sebagai Sumpah Pemuda, yang menjadi tonggak penting persatuan nasional.',
                text: 'Pilihlah Benar atau Salah pada pernyataan berikut terkait Sumpah Pemuda!',
                statements: [
                    'Sumpah Pemuda menekankan penggunaan bahasa Indonesia sebagai bahasa persatuan.',
                    'Sumpah Pemuda adalah hasil kesepakatan seluruh organisasi kepemudaan yang bersifat kedaerahan.',
                    'Setelah Sumpah Pemuda, pemerintah kolonial Belanda memberikan kebebasan penuh pada organisasi politik.'
                ],
                answers: ['Benar', 'Benar', 'Salah'],
                explanation: 'Sumpah Pemuda menetapkan Bahasa Indonesia (benar) dan melibatkan organisasi kedaerahan (benar). Belanda justru memperketat pengawasan (salah).'
            },

            // --- Q31: Tiga Serangkai (IP) ---
            {
                qNum: 31,
                type: 'mc',
                topic: 'Indische Partij (IP) didirikan oleh Tiga Serangkai: Douwes Dekker, Cipto Mangunkusumo, dan Ki Hajar Dewantara.',
                text: 'Alasan utama pemerintah kolonial Belanda membubarkan Indische Partij dan mengasingkan para pendirinya adalah karena IP...',
                options: [
                    'A. Melakukan aksi kekerasan dan pemberontakan bersenjata.',
                    'B. Meminta kemerdekaan penuh bagi Indonesia saat itu juga.',
                    'C. Menciptakan kesadaran politik untuk mempersatukan kaum pribumi dan Indo-Belanda.',
                    'D. Berafiliasi dengan komunis internasional (Komintern).',
                    'E. Menolak keras kebijakan tanam paksa.'
                ],
                answer: 'C',
                explanation: 'IP dianggap berbahaya karena menyatukan berbagai kelompok untuk melawan diskriminasi dan menumbuhkan kesadaran nasional.'
            },

            // --- Q32: Organisasi Jepang - PETA ---
            {
                qNum: 32,
                type: 'ms',
                topic: 'Pada masa pendudukan Jepang, dibentuk berbagai organisasi semi-militer, salah satunya adalah Pembela Tanah Air (PETA).',
                text: 'Manakah pernyataan yang menunjukkan peran Pembela Tanah Air (PETA) dalam konteks persiapan kemerdekaan Indonesia? Jawaban benar lebih dari satu.',
                options: [
                    'PETA dibentuk atas inisiatif dan pendanaan sepenuhnya dari pemimpin nasional Indonesia.',
                    'PETA memberikan pelatihan militer kepada pemuda Indonesia yang berguna setelah proklamasi.',
                    'PETA menjadi cikal bakal terbentuknya Tentara Nasional Indonesia (TNI).',
                    'PETA adalah organisasi yang secara terang-terangan menentang propaganda Jepang.',
                    'Para anggota PETA memiliki pengalaman memimpin pasukan di tingkat komandan peleton.'
                ],
                answers: [false, true, true, false, true],
                explanation: 'PETA dibentuk Jepang (bukan inisiatif sendiri) tetapi memberikan pelatihan militer, menjadi cikal bakal TNI, dan melahirkan pemimpin berpengalaman.'
            },

            // --- Q33: Dampak Romusa ---
            {
                qNum: 33,
                type: 'tf',
                topic: 'Romusa adalah sistem kerja paksa yang diterapkan oleh Jepang, jauh lebih kejam daripada kerja rodi pada masa Belanda.',
                text: 'Pilihlah Benar atau Salah terkait dampak dari kebijakan Romusa!',
                statements: [
                    'Romusa menyebabkan penderitaan fisik, kelaparan, dan angka kematian tinggi di kalangan rakyat Indonesia.',
                    'Romusa hanya diterapkan di pulau Jawa, sementara pulau lain bebas dari kerja paksa.',
                    'Secara tidak langsung, Romusa menumbuhkan semangat perlawanan tersembunyi terhadap penjajah.'
                ],
                answers: ['Benar', 'Salah', 'Benar'],
                explanation: 'Romusa sangat kejam (benar), diterapkan luas di Nusantara (salah), dan meningkatkan perlawanan (benar).'
            },

            // --- Q34: Peristiwa Rengasdengklok ---
            {
                qNum: 34,
                type: 'mc',
                topic: 'Peristiwa Rengasdengklok terjadi sehari sebelum Proklamasi Kemerdekaan Indonesia, 16 Agustus 1945.',
                text: 'Apa tujuan utama golongan muda membawa Soekarno dan Hatta ke Rengasdengklok?',
                options: [
                    'A. Melindungi mereka dari ancaman pasukan Sekutu.',
                    'B. Mempersiapkan teks Proklamasi secara rahasia.',
                    'C. Mendesak Soekarno-Hatta untuk segera memproklamasikan kemerdekaan tanpa pengaruh Jepang.',
                    'D. Menetapkan dasar negara Indonesia yang baru (Pancasila).',
                    'E. Merumuskan struktur kabinet Indonesia pertama.'
                ],
                answer: 'C',
                explanation: 'Tujuan utama adalah menjauhkan Soekarno-Hatta dari pengaruh Jepang agar proklamasi murni merupakan kehendak bangsa Indonesia.'
            },

            // --- Q35: Peran BPUPKI & PPKI ---
            {
                qNum: 35,
                type: 'ms',
                topic: 'Badan Penyelidik Usaha-usaha Persiapan Kemerdekaan Indonesia (BPUPKI) dan Panitia Persiapan Kemerdekaan Indonesia (PPKI) adalah dua badan penting dalam proses kemerdekaan.',
                text: 'Manakah tugas-tugas yang menjadi tanggung jawab Panitia Persiapan Kemerdekaan Indonesia (PPKI)? Jawaban benar lebih dari satu.',
                options: [
                    'Menyusun dasar negara (Pancasila) dan UUD 1945.',
                    'Mengesahkan UUD 1945.',
                    'Memilih Presiden dan Wakil Presiden (Soekarno-Hatta).',
                    'Menetapkan 8 Provinsi di awal kemerdekaan.',
                    'Membentuk Angkatan Perang di bawah komando Jepang.'
                ],
                answers: [false, true, true, true, false],
                explanation: 'BPUPKI menyusun dasar negara (salah). PPKI bertugas mengesahkan UUD, memilih Presiden/Wapres, dan menetapkan pemerintahan awal (benar).'
            },

            // --- Q36: Makna Proklamasi ---
            {
                qNum: 36,
                type: 'mc',
                topic: 'Proklamasi 17 Agustus 1945 adalah puncak perjuangan bangsa Indonesia.',
                text: 'Selain sebagai pernyataan kemerdekaan, proklamasi juga memiliki makna lain, yaitu sebagai...',
                options: [
                    'A. Titik awal perjuangan fisik melawan Belanda dan Sekutu.',
                    'B. Akhir dari seluruh masalah dan penderitaan rakyat.',
                    'C. Pernyataan formal berdirinya negara baru secara de facto dan de jure.',
                    'D. Pengumuman untuk melaksanakan pemilihan umum pertama.',
                    'E. Permintaan bantuan kepada PBB untuk pengakuan kedaulatan.'
                ],
                answer: 'C',
                explanation: 'Proklamasi adalah pernyataan resmi kepada dunia bahwa Indonesia telah merdeka secara de facto (nyata) dan de jure (hukum).'
            },

            // --- Q37: Agresi Militer Belanda ---
            {
                qNum: 37,
                type: 'tf',
                topic: 'Belanda melakukan dua Agresi Militer, yaitu Agresi Militer I (1947) dan Agresi Militer II (1948), yang melanggar perjanjian damai.',
                text: 'Pilihlah Benar atau Salah terkait Agresi Militer Belanda!',
                statements: [
                    'Agresi Militer I dilakukan Belanda setelah melanggar Perjanjian Linggarjati.',
                    'Tujuan Agresi Militer II adalah untuk merebut kota Yogyakarta yang saat itu menjadi ibu kota RI.',
                    'Kedua Agresi Militer Belanda berhasil mendapatkan dukungan penuh dari Dewan Keamanan PBB.'
                ],
                answers: ['Benar', 'Benar', 'Salah'],
                explanation: 'Agresi I melanggar Linggarjati (benar). Agresi II menyerang Yogyakarta (benar). PBB justru menentang (salah).'
            },

            // --- Q38: Perundingan Penting ---
            {
                qNum: 38,
                type: 'ms',
                topic: 'Setelah proklamasi, Indonesia terlibat dalam berbagai perundingan dengan Belanda, seperti Linggarjati, Renville, dan Roem-Royen.',
                text: 'Manakah yang merupakan poin-poin kesepakatan dari Perjanjian Renville? Jawaban benar lebih dari satu.',
                options: [
                    'Belanda hanya mengakui wilayah RI meliputi Jawa Tengah, Yogyakarta, dan Sumatra.',
                    'Pengakuan kedaulatan RI atas seluruh bekas wilayah Hindia Belanda.',
                    'Pembentukan Republik Indonesia Serikat (RIS).',
                    'Garis demarkasi (garis Van Mook) sebagai batas wilayah RI dan Belanda.',
                    'Penarikan mundur pasukan RI dari wilayah yang diduduki Belanda (Hijrah).'
                ],
                answers: [true, false, false, true, true],
                explanation: 'Renville membatasi wilayah RI, menetapkan garis Van Mook, dan mewajibkan Hijrah (penarikan mundur).'
            },

            // --- Q39: Konferensi Meja Bundar (KMB) ---
            {
                qNum: 39,
                type: 'mc',
                topic: 'Konferensi Meja Bundar (KMB) yang diadakan di Den Haag pada 1949 menjadi akhir dari konflik fisik Indonesia-Belanda.',
                text: 'Hasil paling krusial dari Konferensi Meja Bundar (KMB) bagi Indonesia adalah...',
                options: [
                    'A. Pembentukan Uni Indonesia-Belanda.',
                    'B. Pengakuan kedaulatan RI oleh Belanda secara penuh dan tanpa syarat.',
                    'C. Penyerahan Irian Barat (Papua) kepada Indonesia pada tahun 1950.',
                    'D. Indonesia wajib membayar seluruh utang Hindia Belanda.',
                    'E. Penarikan mundur seluruh pasukan Indonesia dari wilayah Belanda.'
                ],
                answer: 'B',
                explanation: 'Pengakuan kedaulatan oleh Belanda adalah hasil terpenting KMB. Masalah Irian Barat ditunda.'
            },

            // --- Q40: Demokrasi Parlementer ---
            {
                qNum: 40,
                type: 'tf',
                topic: 'Periode 1950-1959 dikenal sebagai era Demokrasi Parlementer, di mana kabinet sering berganti karena sistem multi-partai dan kurangnya stabilitas politik.',
                text: 'Pilihlah Benar atau Salah terkait Demokrasi Parlementer!',
                statements: [
                    'Kekuasaan eksekutif tertinggi berada di tangan Perdana Menteri.',
                    'Indonesia berhasil menyelenggarakan Pemilihan Umum pertama pada tahun 1955.',
                    'Ketidakstabilan politik ditandai dengan seringnya jatuh bangun kabinet dalam waktu singkat.'
                ],
                answers: ['Benar', 'Benar', 'Benar'],
                explanation: 'Dalam sistem parlementer, PM memegang kekuasaan (benar). Pemilu pertama tahun 1955 (benar). Era ini ditandai instabilitas kabinet (benar).'
            }
        ];

        // =================================================================
        // 2. FUNGSI UTILITY (Pengiriman Pesan Non-Blocking)
        // =================================================================
        function displayMessage(message, type = 'success', duration = 5000) {
            const messageBox = document.getElementById('messageBox');
            const messageItem = document.createElement('div');
            messageItem.textContent = message;
            messageItem.className = `message-item ${type === 'success' ? 'message-success' : 'message-error'}`;
            
            messageBox.prepend(messageItem);

            setTimeout(() => {
                messageItem.style.opacity = '0';
                messageItem.addEventListener('transitionend', () => messageItem.remove());
            }, duration);
        }

        function showLoading(show) {
            document.getElementById('loadingModal').style.display = show ? 'flex' : 'none';
        }

        // =================================================================
        // 3. FUNGSI PENGIRIMAN DATA (Komunikasi dengan Apps Script)
        // =================================================================
        async function kirimHasilKuis(namaSiswa, skorAkhir, waktuSelesai) {
            showLoading(true);

            const dataKuis = {
                namaSiswa: namaSiswa,
                nilaiSkor: skorAkhir,
                waktuSelesai: waktuSelesai
            };

            const formData = new URLSearchParams();
            for (const key in dataKuis) {
                formData.append(key, dataKuis[key]);
            }

            try {
                const response = await fetch(WEB_APP_URL, {
                    method: 'POST',
                    body: formData,
                });

                // Jika status HTTP OK (200-299), lanjutkan
                if (!response.ok && response.type !== 'opaque') {
                    throw new Error(`Gagal koneksi. Status: ${response.status}`);
                }
                
                const resultText = await response.text();

                // Dalam banyak kasus GAS, respon 'opaque' dianggap sukses
                if (response.type === 'opaque' || resultText.trim() === "SUCCESS") {
                    console.log("✅ Data berhasil tersimpan.");
                    displayMessage("✅ Data hasil kuis Anda berhasil dikirim dan tersimpan di Google Sheet!", 'success');
                } else {
                    // Hanya tampilkan error jika bukan respon opaque yang gagal diparse
                    console.error("❌ Gagal menyimpan data. Respon Server:", resultText);
                    displayMessage("Penyimpanan gagal. Cek Apps Script Log untuk detail ERROR.", 'error');
                }

            } catch (error) {
                console.error("🚨 Kesalahan Jaringan/Fetch:", error);
                displayMessage("Kesalahan Jaringan. Pastikan Anda Online dan URL Web App benar.", 'error');
            } finally {
                showLoading(false);
            }
        }


        // =================================================================
        // 4. LOGIKA KUIS UTAMA (State Management)
        // =================================================================
        let userAnswers = {};
        let startTime = null;
        let currentPage = 'intro';
        const contentDiv = document.getElementById('content');
        const submitButton = document.getElementById('submitButton');
        const pageTitle = document.getElementById('pageTitle');

        function setPage(pageName) {
            currentPage = pageName;
            render();
        }

        function render() {
            contentDiv.innerHTML = '';
            submitButton.classList.add('hidden');

            switch (currentPage) {
                case 'intro':
                    renderIntro();
                    pageTitle.textContent = 'Selamat Datang';
                    break;
                case 'quiz':
                    renderQuiz();
                    pageTitle.textContent = `Total ${quizQuestions.length} Soal`;
                    submitButton.classList.remove('hidden');
                    break;
                case 'results':
                    renderResults();
                    pageTitle.textContent = 'Hasil Kuis';
                    break;
            }
        }

        // --- Render Halaman Intro ---
        function renderIntro() {
            contentDiv.innerHTML = `
                <div class="space-y-6 text-center">
                    <p class="text-gray-600 text-xl">Silakan masukkan nama Anda untuk memulai kuis sejarah. Kuis terdiri dari ${quizQuestions.length} soal.</p>
                    <div class="max-w-md mx-auto">
                        <input type="text" id="inputNama" placeholder="Nama Lengkap Anda" class="w-full p-3 border-2 border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
                    </div>
                    <button onclick="startQuiz()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg shadow-lg transition duration-300">
                        Mulai Kuis Sekarang
                    </button>
                </div>
            `;
        }

        function startQuiz() {
            const nama = document.getElementById('inputNama').value.trim();
            if (nama.length < 3) {
                displayMessage("Mohon masukkan nama lengkap Anda (minimal 3 karakter).", 'error');
                return;
            }
            // Reset jawaban dan mulai timer
            userAnswers = {}; 
            startTime = Date.now(); 
            setPage('quiz');
        }


        // --- Render Halaman Kuis ---
        function renderQuiz() {
            const quizHtml = quizQuestions.map((q, index) => {
                const questionIndex = q.qNum - 1;
                
                let inputType = '';
                let optionsHtml = '';

                if (q.type === 'mc') {
                    inputType = 'radio';
                    optionsHtml = q.options.map(option => `
                        <label class="flex items-center p-3 my-2 border border-gray-200 rounded-lg option-label">
                            <input type="${inputType}" name="q${q.qNum}" value="${option.charAt(0)}" 
                                ${userAnswers[questionIndex] === option.charAt(0) ? 'checked' : ''} 
                                onchange="handleAnswer(${questionIndex}, event)" class="mr-3 text-blue-600 focus:ring-blue-500 h-5 w-5" />
                            <span class="text-gray-700">${option}</span>
                        </label>
                    `).join('');
                } else if (q.type === 'tf') {
                    inputType = 'radio';
                    optionsHtml = q.statements.map((statement, stmtIndex) => `
                        <div class="border border-gray-200 p-4 rounded-lg my-3">
                            <p class="font-semibold text-gray-800 mb-2">${statement}</p>
                            <div class="flex space-x-4">
                                <label class="flex items-center p-2 rounded-lg option-label border">
                                    <input type="${inputType}" name="q${q.qNum}_${stmtIndex}" value="Benar" 
                                        ${userAnswers[questionIndex] && userAnswers[questionIndex][stmtIndex] === 'Benar' ? 'checked' : ''}
                                        onchange="handleTFAnswer(${questionIndex}, ${stmtIndex}, event)" class="mr-2 text-blue-600 focus:ring-blue-500 h-4 w-4" />
                                    <span class="text-green-600">Benar</span>
                                </label>
                                <label class="flex items-center p-2 rounded-lg option-label border">
                                    <input type="${inputType}" name="q${q.qNum}_${stmtIndex}" value="Salah" 
                                        ${userAnswers[questionIndex] && userAnswers[questionIndex][stmtIndex] === 'Salah' ? 'checked' : ''}
                                        onchange="handleTFAnswer(${questionIndex}, ${stmtIndex}, event)" class="mr-2 text-red-600 focus:ring-red-500 h-4 w-4" />
                                    <span class="text-red-600">Salah</span>
                                </label>
                            </div>
                        </div>
                    `).join('');
                } else if (q.type === 'ms') {
                     inputType = 'checkbox';
                    optionsHtml = q.options.map((option, optIndex) => `
                        <label class="flex items-start p-3 my-2 border border-gray-200 rounded-lg option-label">
                            <input type="${inputType}" name="q${q.qNum}" value="${optIndex}" 
                                ${userAnswers[questionIndex] && userAnswers[questionIndex].includes(optIndex) ? 'checked' : ''} 
                                onchange="handleMSAnswer(${questionIndex}, ${optIndex}, event)" class="mr-3 mt-1 text-blue-600 focus:ring-blue-500 h-5 w-5" />
                            <span class="text-gray-700">${option}</span>
                        </label>
                    `).join('');
                }

                return `
                    <div class="mb-10 p-5 border border-gray-200 rounded-xl shadow-sm">
                        <p class="text-sm font-medium text-blue-500 mb-2">Soal No. ${q.qNum} (${q.type === 'ms' ? 'Pilih Banyak' : q.type === 'tf' ? 'Benar/Salah' : 'Pilihan Ganda'})</p>
                        <div class="question-container">
                            <p class="text-xs text-gray-500 italic mb-3">${q.topic}</p>
                            <p class="text-lg font-semibold text-gray-800 mb-4">${q.text}</p>
                        </div>
                        <div class="mt-4 space-y-2">
                            ${optionsHtml}
                        </div>
                    </div>
                `;
            }).join('');

            contentDiv.innerHTML = quizHtml;
        }

        // --- Handler Jawaban (MC & TF) ---
        function handleAnswer(qIndex, event) {
            userAnswers[qIndex] = event.target.value;
        }

        // --- Handler Jawaban Benar/Salah (TF) ---
        function handleTFAnswer(qIndex, stmtIndex, event) {
            if (!userAnswers[qIndex]) {
                userAnswers[qIndex] = {};
            }
            userAnswers[qIndex][stmtIndex] = event.target.value;
        }

        // --- Handler Jawaban Pilih Banyak (MS) ---
        function handleMSAnswer(qIndex, optIndex, event) {
            if (!userAnswers[qIndex]) {
                userAnswers[qIndex] = [];
            }
            if (event.target.checked) {
                if (!userAnswers[qIndex].includes(optIndex)) {
                    userAnswers[qIndex].push(optIndex);
                }
            } else {
                userAnswers[qIndex] = userAnswers[qIndex].filter(i => i !== optIndex);
            }
        }


        // --- Menghitung Skor & Submit ---
        function calculateScore() {
            let totalScore = 0;
            let maxScore = quizQuestions.length; // Setiap soal bernilai 1 poin

            quizQuestions.forEach((q, index) => {
                const userAnswer = userAnswers[index];
                
                if (!userAnswer) return; // Lewati jika tidak dijawab

                let isCorrect = false;

                if (q.type === 'mc') {
                    // Pilihan Ganda (MC)
                    if (userAnswer === q.answer) {
                        isCorrect = true;
                    }
                } else if (q.type === 'tf') {
                    // Benar/Salah (TF) - Harus benar semua pernyataan
                    isCorrect = q.statements.every((_, stmtIndex) => {
                        return userAnswer[stmtIndex] === q.answers[stmtIndex];
                    });
                } else if (q.type === 'ms') {
                    // Pilih Banyak (MS) - Harus memilih semua yang benar dan tidak memilih yang salah
                    const correctIndices = q.answers
                        .map((isCorrect, i) => isCorrect ? i : null)
                        .filter(i => i !== null);

                    const userSelectedIndices = Array.isArray(userAnswer) ? userAnswer.sort((a,b) => a-b) : [];
                    
                    // Cek apakah jawaban user sama persis dengan jawaban benar
                    if (userSelectedIndices.length === correctIndices.length && 
                        userSelectedIndices.every((val, idx) => val === correctIndices[idx])) {
                        isCorrect = true;
                    }
                }

                if (isCorrect) {
                    totalScore += 1;
                }
            });

            // Konversi skor ke skala 100
            const finalScore = Math.round((totalScore / maxScore) * 100);
            
            return { totalScore, maxScore, finalScore };
        }

        function submitQuiz() {
            const { totalScore, maxScore, finalScore } = calculateScore();
            const inputNamaElement = document.getElementById('inputNama');
            const namaSiswa = inputNamaElement ? inputNamaElement.value.trim() : 'Anonim';
            const endTime = Date.now();
            const timeElapsedSeconds = Math.round((endTime - startTime) / 1000);

            // 1. Kirim data ke Apps Script
            kirimHasilKuis(namaSiswa, finalScore, timeElapsedSeconds);
            
            // 2. Tampilkan halaman hasil kuis
            setPage('results');
        }

        // --- Render Halaman Hasil ---
        function renderResults() {
            const { totalScore, maxScore, finalScore } = calculateScore();
            const timeElapsedSeconds = Math.round((Date.now() - startTime) / 1000);
            const inputNamaElement = document.getElementById('inputNama');
            const namaSiswa = inputNamaElement ? inputNamaElement.value.trim() : 'Anonim';
            const minutes = Math.floor(timeElapsedSeconds / 60);
            const seconds = timeElapsedSeconds % 60;
            
            let message = '';
            let color = '';

            if (finalScore >= 80) {
                message = "Luar Biasa! Pemahaman Sejarah Anda Sangat Baik.";
                color = "text-green-600";
            } else if (finalScore >= 60) {
                message = "Cukup Baik! Terus Tingkatkan Pemahaman Anda.";
                color = "text-yellow-600";
            } else {
                message = "Perlu Belajar Lebih Keras. Jangan Menyerah!";
                color = "text-red-600";
            }

            contentDiv.innerHTML = `
                <div class="text-center space-y-6 p-8 border border-gray-200 rounded-xl shadow-lg">
                    <h2 class="text-4xl font-bold ${color}">${finalScore}/100</h2>
                    <p class="text-2xl font-semibold text-gray-800">${message}</p>
                    
                    <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-8 text-lg">
                        <div class="p-3 bg-blue-50 rounded-lg">
                            <p class="text-gray-500">Nama Siswa</p>
                            <p class="font-bold text-blue-800">${namaSiswa}</p>
                        </div>
                        <div class="p-3 bg-blue-50 rounded-lg">
                            <p class="text-gray-500">Jawaban Benar</p>
                            <p class="font-bold text-blue-800">${totalScore} dari ${maxScore}</p>
                        </div>
                        <div class="p-3 bg-blue-50 rounded-lg">
                            <p class="text-gray-500">Waktu Pengerjaan</p>
                            <p class="font-bold text-blue-800">${minutes} menit ${seconds} detik</p>
                        </div>
                    </div>

                    <p class="text-sm text-gray-500 mt-6">
                        Data hasil kuis ini telah dikirim ke Google Sheet Anda.
                    </p>
                    <button onclick="setPage('intro')" class="mt-4 bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-6 rounded-lg transition duration-300">
                        Ulangi Kuis
                    </button>
                </div>
            `;
        }

        // Mulai aplikasi
        window.onload = () => {
            render();
        };

    </script>
</body>
</html>
